# –° –∫–∞–∫–æ–π —Ü–µ–ª—å—é –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω event listener —Å–æ–±—ã—Ç–∏—è fetch self.addEventListener `( 'fetch', event => {})`?

**–û—Ç–≤–µ—Ç:**

**Service Worker** ‚Äî —ç—Ç–æ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫ –º–µ–∂–¥—É —Å–∞–π—Ç–æ–º –∏ —Å–µ—Ç—å—é. –ú–æ–∂–µ—Ç **–ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å** –≤—Å–µ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏ —Ä–µ—à–∞—Ç—å, —á—Ç–æ —Å –Ω–∏–º–∏ –¥–µ–ª–∞—Ç—å.

```javascript
// üîç Service Worker - –ø–µ—Ä–µ—Ö–≤–∞—Ç –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

self.addEventListener('fetch', event => {
  console.log('–ü–µ—Ä–µ—Ö–≤–∞—Ç–∏–ª–∏ –∑–∞–ø—Ä–æ—Å:', event.request.url);
  
  // üóÑÔ∏è –ö–≠–®–ò–†–û–í–ê–ù–ò–ï - —Å–Ω–∞—á–∞–ª–∞ –∫—ç—à, –ø–æ—Ç–æ–º —Å–µ—Ç—å
  if (event.request.destination === 'image') {
    event.respondWith(
      caches.match(event.request)          // –ò—â–µ–º –≤ –∫—ç—à–µ
        .then(cached => {
          if (cached) {
            console.log('–ò–∑ –∫—ç—à–∞:', event.request.url);
            return cached;                 // –û—Ç–¥–∞–µ–º –∏–∑ –∫—ç—à–∞
          }
          
          return fetch(event.request)      // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ —Å–µ—Ç–∏
            .then(response => {
              const cache = caches.open('images-v1');
              cache.then(c => c.put(event.request, response.clone()));
              return response;
            });
        })
    );
  }
  
  // üì± –û–§–õ–ê–ô–ù –†–ï–ñ–ò–ú - fallback –∫–æ–≥–¥–∞ —Å–µ—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
  if (event.request.url.includes('/api/')) {
    event.respondWith(
      fetch(event.request)
        .then(response => response)
        .catch(() => {
          // –°–µ—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
          return caches.match('/offline.html');
        })
    );
  }
  
  // üîß –ú–û–î–ò–§–ò–ö–ê–¶–ò–Ø –ó–ê–ü–†–û–°–û–í - –¥–æ–±–∞–≤–ª—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
  if (event.request.url.includes('/secure-api/')) {
    const modifiedRequest = new Request(event.request.url, {
      method: event.request.method,
      headers: {
        ...event.request.headers,
        'Authorization': 'Bearer my-secret-token'  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω
      }
    });
    
    event.respondWith(fetch(modifiedRequest));
  }
});

// üöÄ –ü–†–ï–î–ó–ê–ì–†–£–ó–ö–ê - –∑–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ—Å—É—Ä—Å—ã –∑–∞—Ä–∞–Ω–µ–µ
self.addEventListener('fetch', event => {
  if (event.request.url.includes('/page1')) {
    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—à–µ–ª –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É 1, –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É 2
    caches.open('pages').then(cache => {
      cache.add('/page2');
    });
  }
});
```

**üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:**

**üìä 1. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**
```javascript
// –°—Ç—Ä–∞—Ç–µ–≥–∏—è "Cache First" - –±—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
caches.match(request) || fetch(request)
```

**üì± 2. Offline —Ä–µ–∂–∏–º**
```javascript
// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Ñ–ª–∞–π–Ω —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤–º–µ—Å—Ç–æ –æ—à–∏–±–∫–∏
fetch(request).catch(() => caches.match('/offline.html'))
```

**üîí 3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
```javascript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
```

**üìà 4. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞**
```javascript
// –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

**üß† –ö–∞–∫ –∑–∞–ø–æ–º–Ω–∏—Ç—å?**
Service Worker = **—Å–µ—Ä–≤–∏—Å-–æ—Ñ–∏—Ü–∏–∞–Ω—Ç** ‚Äî –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–∫–∞–∑—ã (–∑–∞–ø—Ä–æ—Å—ã) –∏ —Ä–µ—à–∞–µ—Ç –æ—Ç–∫—É–¥–∞ –∏—Ö –≤–∑—è—Ç—å

**‚ö° –ü–æ–ª–µ–∑–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:**
- **Cache First** ‚Üí –±—ã—Å—Ç—Ä–æ (—Å–Ω–∞—á–∞–ª–∞ –∫—ç—à)
- **Network First** ‚Üí —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ (—Å–Ω–∞—á–∞–ª–∞ —Å–µ—Ç—å)
- **Stale While Revalidate** ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ä–æ–µ, –æ–±–Ω–æ–≤–∏—Ç—å –≤ —Ñ–æ–Ω–µ

**–í—ã–≤–æ–¥:**
Fetch event listener –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã ‚Äî –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å, —Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ñ–ª–∞–π–Ω, –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã.