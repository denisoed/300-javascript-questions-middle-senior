# –ß—Ç–æ —Ç–∞–∫–æ–µ Promise? –ù–∞–∑–æ–≤–∏—Ç–µ –ø–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è then –∏ catch –≤ —Ü–µ–ø–æ—á–∫–µ

```javascript
Promise.resolve(10)
  .then(e => console.log(e)) // ??
  .then(e => Promise.resolve(e))
  .then(console.log) // ??
  .then(e => {
    if (!e) {
      throw 'Error caught';
    }
  })
  .catch(e => {
    console.log(e); // ??
    return new Error('New error');
  })
  .then(e => {
    console.log(e.message); // ??
  })
  .catch(e => {
    console.log(e.message); // ??
  });
```

## –û—Ç–≤–µ—Ç

üéØ **Promise** ‚Äî —ç—Ç–æ **"–æ–±–µ—â–∞–Ω–∏–µ" –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç** –≤ –±—É–¥—É—â–µ–º. –ö–∞–∫ –∑–∞–∫–∞–∑ –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ: –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –Ω–æ–º–µ—Ä–æ–∫ –∏ –∂–¥–µ—Ç–µ, –ø–æ–∫–∞ –ø—Ä–∏–≥–æ—Ç–æ–≤—è—Ç –±–ª—é–¥–æ. Promise –º–æ–∂–µ—Ç **–≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è** (resolve) –∏–ª–∏ **–ø—Ä–æ–≤–∞–ª–∏—Ç—å—Å—è** (reject).

### üîç –û—Å–Ω–æ–≤—ã Promise

```javascript
// Promise –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ 3 —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö:
// 1. PENDING (–æ–∂–∏–¥–∞–Ω–∏–µ) - –µ—â–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
// 2. FULFILLED (–≤—ã–ø–æ–ª–Ω–µ–Ω) - —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω
// 3. REJECTED (–æ—Ç–∫–ª–æ–Ω–µ–Ω) - –∑–∞–≤–µ—Ä—à–µ–Ω —Å –æ—à–∏–±–∫–æ–π

const simplePromise = new Promise((resolve, reject) => {
  const success = Math.random() > 0.5;
  
  setTimeout(() => {
    if (success) {
      resolve('–£—Å–ø–µ—Ö!'); // –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ FULFILLED
    } else {
      reject('–û—à–∏–±–∫–∞!'); // –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ REJECTED
    }
  }, 1000);
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:
simplePromise
  .then(result => console.log('–ü–æ–ª—É—á–∏–ª–∏:', result))   // –î–ª—è —É—Å–ø–µ—Ö–∞
  .catch(error => console.error('–û—à–∏–±–∫–∞:', error));   // –î–ª—è –ø—Ä–æ–≤–∞–ª–∞
```

### üîç –ü–æ—à–∞–≥–æ–≤—ã–π —Ä–∞–∑–±–æ—Ä —Ü–µ–ø–æ—á–∫–∏

```javascript
// –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–∞–∂–¥—ã–π —à–∞–≥ —Ü–µ–ø–æ—á–∫–∏:

Promise.resolve(10)                    // –ù–∞—á–∏–Ω–∞–µ–º —Å resolved Promise —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º 10
  
  .then(e => console.log(e))           // –®–ê–ì 1Ô∏è‚É£
  // e = 10
  // –í—ã–≤–æ–¥–∏—Ç: 10
  // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: undefined (—Ä–µ–∑—É–ª—å—Ç–∞—Ç console.log)
  
  .then(e => Promise.resolve(e))       // –®–ê–ì 2Ô∏è‚É£  
  // e = undefined (—Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ then)
  // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: Promise.resolve(undefined)
  // Promise –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç—Å—è –≤ undefined
  
  .then(console.log)                   // –®–ê–ì 3Ô∏è‚É£
  // e = undefined
  // –í—ã–≤–æ–¥–∏—Ç: undefined
  // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: undefined (—Ä–µ–∑—É–ª—å—Ç–∞—Ç console.log)
  
  .then(e => {                         // –®–ê–ì 4Ô∏è‚É£
    if (!e) {                          // !undefined = true
      throw 'Error caught';            // –ë—Ä–æ—Å–∞–µ–º –æ—à–∏–±–∫—É!
    }
    // –≠—Ç–æ—Ç –∫–æ–¥ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è
  })
  
  .catch(e => {                        // –®–ê–ì 5Ô∏è‚É£ - –ª–æ–≤–∏–º –æ—à–∏–±–∫—É
    console.log(e);                    // e = 'Error caught'
    // –í—ã–≤–æ–¥–∏—Ç: Error caught
    return new Error('New error');     // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–æ–≤—ã–π Error –æ–±—ä–µ–∫—Ç
  })
  
  .then(e => {                         // –®–ê–ì 6Ô∏è‚É£
    console.log(e.message);            // e = Error –æ–±—ä–µ–∫—Ç
    // –í—ã–≤–æ–¥–∏—Ç: New error (—Å–≤–æ–π—Å—Ç–≤–æ message –æ–±—ä–µ–∫—Ç–∞ Error)
    // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: undefined
  })
  
  .catch(e => {                        // –®–ê–ì 7Ô∏è‚É£
    console.log(e.message);            // –ù–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è!
    // –ü—Ä–µ–¥—ã–¥—É—â–∏–π then –Ω–µ –±—Ä–æ—Å–∏–ª –æ—à–∏–±–∫—É
  });

// üéØ –§–ò–ù–ê–õ–¨–ù–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢ –í –ö–û–ù–°–û–õ–ò:
// 10
// undefined  
// Error caught
// New error
```

### üîç –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ Promise —Ü–µ–ø–æ—á–µ–∫

#### 1Ô∏è‚É£ –ü—Ä–∞–≤–∏–ª–æ –≤–æ–∑–≤—Ä–∞—Ç–∞: —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç then, –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π

```javascript
Promise.resolve('start')
  .then(value => {
    console.log(value); // "start"
    return 'middle';    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç—Ä–æ–∫—É
  })
  .then(value => {
    console.log(value); // "middle" ‚úÖ
    return Promise.resolve('end'); // –í–æ–∑–≤—Ä–∞—â–∞–µ–º Promise
  })
  .then(value => {
    console.log(value); // "end" ‚úÖ (Promise –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è)
  });
```

#### 2Ô∏è‚É£ –ü—Ä–∞–≤–∏–ª–æ –æ—à–∏–±–æ–∫: catch –ª–æ–≤–∏—Ç –ª—é–±—ã–µ –æ—à–∏–±–∫–∏ –≤—ã—à–µ –ø–æ —Ü–µ–ø–æ—á–∫–µ

```javascript
Promise.resolve('ok')
  .then(() => {
    throw new Error('–£–ø—Å!'); // –ë—Ä–æ—Å–∞–µ–º –æ—à–∏–±–∫—É
  })
  .then(() => {
    console.log('–ù–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è'); // –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏
  })
  .catch(error => {
    console.log('–ü–æ–π–º–∞–ª–∏:', error.message); // "–ü–æ–π–º–∞–ª–∏: –£–ø—Å!"
    return 'recovered'; // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è
  })
  .then(value => {
    console.log('–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º:', value); // "–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º: recovered" ‚úÖ
  });
```

#### 3Ô∏è‚É£ –ü—Ä–∞–≤–∏–ª–æ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏: undefined –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å

```javascript
Promise.resolve(42)
  .then(value => {
    console.log(value); // 42
    // –ù–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–∏—á–µ–≥–æ = –≤–æ–∑–≤—Ä–∞—â–∞–µ–º undefined
  })
  .then(value => {
    console.log(value); // undefined ‚úÖ
    return 'next';
  })
  .then(value => {
    console.log(value); // "next" ‚úÖ
  });
```

#### 4Ô∏è‚É£ –ü—Ä–∞–≤–∏–ª–æ catch: –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —É—Å–ø–µ—à–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º

```javascript
Promise.reject('error')
  .catch(error => {
    console.log('–û–±—Ä–∞–±–æ—Ç–∞–ª–∏:', error); // "–û–±—Ä–∞–±–æ—Ç–∞–ª–∏: error"
    return 'fixed'; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —É—Å–ø–µ—à–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  })
  .then(value => {
    console.log('–¢–µ–ø–µ—Ä—å —É—Å–ø–µ—Ö:', value); // "–¢–µ–ø–µ—Ä—å —É—Å–ø–µ—Ö: fixed" ‚úÖ
  })
  .catch(() => {
    console.log('–ù–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è'); // –ù–µ—Ç –Ω–æ–≤—ã—Ö –æ—à–∏–±–æ–∫
  });
```

### üîç –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

#### üöÄ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

```javascript
// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
function fetchUserProfile(userId) {
  return fetch(`/api/users/${userId}`)
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }
      return response.json();
    })
    .then(userData => {
      console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω:', userData.name);
      return userData;
    })
    .catch(error => {
      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error.message);
      return { name: '–ì–æ—Å—Ç—å', id: null }; // Fallback –¥–∞–Ω–Ω—ã–µ
    });
}

// –¶–µ–ø–æ—á–∫–∞ –∑–∞–≤–∏—Å–∏–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
function loadUserWithPosts(userId) {
  return fetchUserProfile(userId)
    .then(user => {
      if (!user.id) {
        throw new Error('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω');
      }
      
      // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ—Å—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      return fetch(`/api/users/${user.id}/posts`)
        .then(response => response.json())
        .then(posts => ({
          user: user,
          posts: posts
        }));
    })
    .catch(error => {
      console.error('–û—à–∏–±–∫–∞:', error.message);
      return { user: null, posts: [] };
    });
}
```

#### üéØ –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö Promise

```javascript
function delay(ms) {
  return new Promise(resolve => {
    setTimeout(resolve, ms);
  });
}

function countdown(seconds) {
  return new Promise((resolve, reject) => {
    if (seconds < 0) {
      reject(new Error('–í—Ä–µ–º—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º'));
      return;
    }
    
    const interval = setInterval(() => {
      console.log(`–û—Å—Ç–∞–ª–æ—Å—å: ${seconds}`);
      seconds--;
      
      if (seconds < 0) {
        clearInterval(interval);
        resolve('–í—Ä–µ–º—è –≤—ã—à–ª–æ!');
      }
    }, 1000);
  });
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
countdown(3)
  .then(message => console.log(message))
  .catch(error => console.error(error.message));
```

### üß† –ö–∞–∫ –∑–∞–ø–æ–º–Ω–∏—Ç—å?

- **Promise** = "**–û–±–µ—â–∞–Ω–∏–µ**" (–º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –∏–ª–∏ –Ω–∞—Ä—É—à–µ–Ω–æ)
- **then** = "**–ü–æ—Ç–æ–º**" (—á—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ —É—Å–ø–µ—Ö–µ)
- **catch** = "**–ü–æ–π–º–∞—Ç—å**" (—á—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –æ—à–∏–±–∫–µ)
- **–¶–µ–ø–æ—á–∫–∞** = "**–ö–æ–Ω–≤–µ–π–µ—Ä**" (—Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–¥–Ω–æ–≥–æ ‚Üí –≤—Ö–æ–¥ —Å–ª–µ–¥—É—é—â–µ–≥–æ)

### ‚ö° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞

‚úÖ **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ catch** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫  
‚úÖ **–í–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è** –∏–∑ then –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–ª—å—à–µ  
‚úÖ **–ù–µ –∑–∞–±—ã–≤–∞–π—Ç–µ return** –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö  
‚úÖ **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏** –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ

---

**–í—ã–≤–æ–¥:** Promise ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏. –ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è then/catch –ø–æ–º–æ–≥–∞–µ—Ç —Å—Ç—Ä–æ–∏—Ç—å –Ω–∞–¥–µ–∂–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –æ—à–∏–±–æ–∫. 