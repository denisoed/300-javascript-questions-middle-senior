# –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω ¬´–ú–æ–¥—É–ª—å¬ª?

**–û—Ç–≤–µ—Ç:**

üéØ **–ü–∞—Ç—Ç–µ—Ä–Ω –ú–æ–¥—É–ª—å** ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞—Ç—å **–ø—Ä–∏–≤–∞—Ç–Ω—É—é –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏** –∏ **–ø—É–±–ª–∏—á–Ω—ã–π API**. –ö–∞–∫ –∫–æ—Ä–æ–±–∫–∞ —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏: —Å–Ω–∞—Ä—É–∂–∏ –≤–∏–¥–Ω–æ —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ.

```javascript
// üîç –û–°–ù–û–í–ê - IIFE (–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤—ã–∑—ã–≤–∞–µ–º–∞—è —Ñ—É–Ω–∫—Ü–∏—è)

const Calculator = (function() {
  // ‚ùå –ü–†–ò–í–ê–¢–ù–û–ï - –Ω–∏–∫—Ç–æ —Å–Ω–∞—Ä—É–∂–∏ –Ω–µ –≤–∏–¥–∏—Ç
  let result = 0;
  let history = [];
  
  function log(operation, value) {
    history.push(`${operation}: ${value}`);
  }
  
  function validate(num) {
    return typeof num === 'number' && !isNaN(num);
  }
  
  // ‚úÖ –ü–£–ë–õ–ò–ß–ù–û–ï - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–∞—Ä—É–∂—É
  return {
    add(num) {
      if (!validate(num)) throw new Error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á–∏—Å–ª–æ');
      result += num;
      log('add', num);
      return this; // –î–ª—è —Ü–µ–ø–æ—á–∫–∏ –≤—ã–∑–æ–≤–æ–≤
    },
    
    subtract(num) {
      if (!validate(num)) throw new Error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á–∏—Å–ª–æ');
      result -= num;
      log('subtract', num);
      return this;
    },
    
    multiply(num) {
      if (!validate(num)) throw new Error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á–∏—Å–ª–æ');
      result *= num;
      log('multiply', num);
      return this;
    },
    
    getResult() {
      return result;
    },
    
    getHistory() {
      return [...history]; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ–ø–∏—é
    },
    
    reset() {
      result = 0;
      history = [];
      return this;
    }
  };
})();

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
Calculator
  .add(10)
  .subtract(3)
  .multiply(2);

console.log(Calculator.getResult()); // 14
console.log(Calculator.getHistory()); // ['add: 10', 'subtract: 3', 'multiply: 2']

// ‚ùå –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã:
// console.log(Calculator.result); // undefined
// console.log(Calculator.history); // undefined
```

**üîç –†–ê–ó–ù–´–ï –í–ê–†–ò–ê–ù–¢–´ –ú–û–î–£–õ–Ø:**

```javascript
// 1Ô∏è‚É£ –ú–û–î–£–õ–¨ –° –ü–ê–†–ê–ú–ï–¢–†–ê–ú–ò

const CounterFactory = function(startValue = 0, step = 1) {
  return (function(start, increment) {
    let count = start;
    
    return {
      next() {
        count += increment;
        return count;
      },
      
      prev() {
        count -= increment;
        return count;
      },
      
      get current() {
        return count;
      },
      
      reset() {
        count = start;
      }
    };
  })(startValue, step);
};

const counter1 = CounterFactory(0, 1);    // –°—á–∏—Ç–∞–µ—Ç 0, 1, 2, 3...
const counter2 = CounterFactory(10, 5);   // –°—á–∏—Ç–∞–µ—Ç 10, 15, 20, 25...

console.log(counter1.next()); // 1
console.log(counter2.next()); // 15

// 2Ô∏è‚É£ REVEALING MODULE PATTERN (–ø–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ–µ)

const UserManager = (function() {
  // –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  const users = [];
  const config = { maxUsers: 100 };
  
  // –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
  function generateId() {
    return Date.now() + Math.random();
  }
  
  function validateUser(userData) {
    return userData && typeof userData.name === 'string';
  }
  
  function addUser(userData) {
    if (users.length >= config.maxUsers) {
      throw new Error('–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π');
    }
    
    if (!validateUser(userData)) {
      throw new Error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
    }
    
    const user = {
      id: generateId(),
      createdAt: new Date(),
      ...userData
    };
    
    users.push(user);
    return user;
  }
  
  function removeUser(id) {
    const index = users.findIndex(user => user.id === id);
    if (index === -1) return false;
    
    users.splice(index, 1);
    return true;
  }
  
  function findUser(id) {
    return users.find(user => user.id === id) || null;
  }
  
  function getAllUsers() {
    return users.map(user => ({ ...user })); // –ì–ª—É–±–æ–∫–∞—è –∫–æ–ø–∏—è
  }
  
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ
  return {
    create: addUser,
    remove: removeUser,
    find: findUser,
    getAll: getAllUsers,
    getCount: () => users.length,
    getLimit: () => config.maxUsers
  };
})();

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
const user1 = UserManager.create({ name: '–ò–≤–∞–Ω', email: 'ivan@test.com' });
const user2 = UserManager.create({ name: '–ú–∞—Ä–∏—è', email: 'maria@test.com' });

console.log(UserManager.getCount()); // 2
console.log(UserManager.find(user1.id)); // –û–±—ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

**üîç –°–û–í–†–ï–ú–ï–ù–ù–´–ï –í–ê–†–ò–ê–ù–¢–´:**

```javascript
// 3Ô∏è‚É£ ES6 –ú–û–î–£–õ–ò (—Ñ–∞–π–ª–æ–≤—ã–µ –º–æ–¥—É–ª–∏)

// üìÑ mathUtils.js
const PI = 3.14159;
let operationsCount = 0;

function logOperation(op) {
  operationsCount++;
  console.log(`–û–ø–µ—Ä–∞—Ü–∏—è ${operationsCount}: ${op}`);
}

export function add(a, b) {
  logOperation(`${a} + ${b}`);
  return a + b;
}

export function multiply(a, b) {
  logOperation(`${a} * ${b}`);
  return a * b;
}

export function calculateCircleArea(radius) {
  logOperation(`–ü–ª–æ—â–∞–¥—å –∫—Ä—É–≥–∞ r=${radius}`);
  return PI * radius * radius;
}

export default {
  version: '1.0.0',
  author: '–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫'
};

// üìÑ main.js
import { add, multiply, calculateCircleArea } from './mathUtils.js';
import info from './mathUtils.js';

console.log(add(5, 3));                    // 8
console.log(calculateCircleArea(10));      // 314.159
console.log(info.version);                 // "1.0.0"

// 4Ô∏è‚É£ –ú–û–î–£–õ–¨-–°–ò–ù–ì–õ–¢–û–ù (–æ–¥–Ω–∞ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –∏–Ω—Å—Ç–∞–Ω—Ü–∏—è)

const DatabaseConnection = (function() {
  let instance = null;
  let connectionCount = 0;
  
  function createConnection() {
    connectionCount++;
    console.log(`–°–æ–∑–¥–∞–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π: ${connectionCount}`);
    
    return {
      id: generateId(),
      host: 'localhost',
      port: 5432,
      isConnected: false,
      
      connect() {
        if (!this.isConnected) {
          this.isConnected = true;
          console.log(`–ü–æ–¥–∫–ª—é—á–µ–Ω –∫ –±–∞–∑–µ ${this.host}:${this.port}`);
        }
        return this;
      },
      
      disconnect() {
        if (this.isConnected) {
          this.isConnected = false;
          console.log('–û—Ç–∫–ª—é—á–µ–Ω –æ—Ç –±–∞–∑—ã');
        }
        return this;
      },
      
      query(sql) {
        if (!this.isConnected) {
          throw new Error('–°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –±–∞–∑–µ');
        }
        console.log(`–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å: ${sql}`);
        return { result: 'mock data' };
      }
    };
  }
  
  function generateId() {
    return Math.random().toString(36).substr(2, 9);
  }
  
  return {
    getInstance() {
      if (!instance) {
        instance = createConnection();
      }
      return instance;
    },
    
    getConnectionCount() {
      return connectionCount;
    }
  };
})();

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏–Ω–≥–ª—Ç–æ–Ω–∞:
const db1 = DatabaseConnection.getInstance();
const db2 = DatabaseConnection.getInstance();

console.log(db1 === db2); // true - —Ç–æ—Ç –∂–µ –æ–±—ä–µ–∫—Ç!
console.log(DatabaseConnection.getConnectionCount()); // 1

db1.connect().query('SELECT * FROM users');
db2.query('SELECT * FROM products'); // –¢–æ—Ç –∂–µ –æ–±—ä–µ–∫—Ç - —É–∂–µ –ø–æ–¥–∫–ª—é—á–µ–Ω
```

**üß† –ö–∞–∫ –∑–∞–ø–æ–º–Ω–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã?**

- **IIFE** = **–ö–æ—Ä–æ–±–∫–∞ —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏** (–ø—Ä–∏–≤–∞—Ç–Ω–æ–µ –≤–Ω—É—Ç—Ä–∏, –ø—É–±–ª–∏—á–Ω–æ–µ —Å–Ω–∞—Ä—É–∂–∏)
- **Revealing** = **–í–∏—Ç—Ä–∏–Ω–∞ –º–∞–≥–∞–∑–∏–Ω–∞** (–ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä, —Å–∫–ª–∞–¥ —Å–∫—Ä—ã—Ç)  
- **–°–∏–Ω–≥–ª—Ç–æ–Ω** = **–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç —Å—Ç—Ä–∞–Ω—ã** (–º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω)

**‚ö° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã:**

```javascript
// ‚úÖ –•–æ—Ä–æ—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –º–æ–¥—É–ª–µ–π:

// 1. –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ –Ω–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã/–º–∞—Å—Å–∏–≤—ã
getUsers() {
  return users.map(user => ({ ...user })); // –ö–æ–ø–∏—è ‚úÖ
  // return users; // –ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ ‚ùå
}

// 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–µ—Ç—Ç–µ—Ä—ã –¥–ª—è —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏—è
get count() { return items.length; }

// 3. –í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
add(item) {
  if (!item || typeof item !== 'object') {
    throw new Error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç');
  }
  // ...
}

// 4. –õ–æ–≥–∏—Ä—É–π—Ç–µ –≤–∞–∂–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
function logAction(action) {
  console.log(`[${new Date().toISOString()}] ${action}`);
}
```

**üìä –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫–æ–π –º–æ–¥—É–ª—å:**

| –°–∏—Ç—É–∞—Ü–∏—è | –ü–∞—Ç—Ç–µ—Ä–Ω | –ü—Ä–∏—á–∏–Ω–∞ |
|----------|---------|---------|
| **–£—Ç–∏–ª–∏—Ç—ã** | IIFE/ES6 –º–æ–¥—É–ª–∏ | –ü—Ä–æ—Å—Ç–æ—Ç–∞ |
| **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º** | Revealing Module | –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ |
| **–û–¥–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** | –°–∏–Ω–≥–ª—Ç–æ–Ω | –≠–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ |
| **–§–∞–±—Ä–∏–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤** | –ú–æ–¥—É–ª—å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ |

**–í—ã–≤–æ–¥:**
–ú–æ–¥—É–ª–∏ —Å–æ–∑–¥–∞—é—Ç –ø—Ä–∏–≤–∞—Ç–Ω—É—é –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—Ç –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º. –í—ã–±–∏—Ä–∞–π—Ç–µ –ø–∞—Ç—Ç–µ—Ä–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–∞–¥–∞—á–∏! 